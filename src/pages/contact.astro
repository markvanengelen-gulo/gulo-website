---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Contact Gulo AI - Let's Connect"
  description="Ready to transform your business with AI? Contact Gulo AI today to schedule a consultation with our AI experts."
>
  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1>Let's Connect</h1>
      <p>Get in touch to explore how practical Technology and AI solutions and Services can optimize your business and drive real results.</p>
    </div>
  </section>

  <!-- Contact Section -->
  <section>
    <div class="container">
      <div class="grid grid-2">
        <!-- Contact Form -->
        <div>
          <h2>Send Us a Message</h2>
          <form id="contact-form" style="display: flex; flex-direction: column; gap: 1rem;">
            <!-- Web3Forms Access Key - This needs to be obtained from web3forms.com -->
            <input type="hidden" name="access_key" value="YOUR_ACCESS_KEY_HERE">
            <!-- Redirect after submission -->
            <input type="hidden" name="redirect" value="false">
            <!-- Email recipient -->
            <input type="hidden" name="email_to" value="mark.vanengelen@gulo.ai">
            
            <div>
              <label for="name" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Name *</label>
              <input 
                type="text" 
                id="name" 
                name="name" 
                required 
                style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
              />
            </div>
            
            <div>
              <label for="email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Email *</label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                required 
                style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
              />
            </div>
            
            <div>
              <label for="company" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Company</label>
              <input 
                type="text" 
                id="company" 
                name="company" 
                style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
              />
            </div>
            
            <div>
              <label for="subject" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Subject *</label>
              <input 
                type="text" 
                id="subject" 
                name="subject" 
                required 
                style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
              />
            </div>
            
            <div>
              <label for="message" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Message *</label>
              <textarea 
                id="message" 
                name="message" 
                required 
                rows="6"
                style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem; resize: vertical;"
              ></textarea>
            </div>
            
            <div id="form-message" style="display: none; padding: 0.75rem; border-radius: 0.5rem; font-weight: 500;"></div>
            
            <button type="submit" id="submit-btn" class="btn btn-primary btn-large">
              <span id="button-text">Send Message</span>
              <span id="button-loading" style="display: none;">Sending...</span>
            </button>
          </form>
        </div>
        
        <!-- Contact Information -->
        <div>
          <h2>Contact Information</h2>
          <p>We're here to help! Reach out to us through any of the following channels:</p>
          
          <div class="card" style="margin-top: 2rem;">
            <h3>üìû Phone</h3>
            <p><a href="tel:+18444053883">(+1 844-405-3883)</a></p>
          </div>
          
          <div class="card" style="margin-top: 1rem;">
            <h3>‚è∞ Business Hours</h3>
            <p>Monday - Friday: 8 to 5 pm pacific time</p>
            <p style="margin-bottom: 0;"><em>24/7 support available for enterprise clients</em></p>
          </div>
          
          <div class="card" style="margin-top: 1rem;">
            <h3>üöÄ Get Started</h3>
            <p>Schedule a free consultation to discuss your AI needs:</p>
            <button id="schedule-appointment-btn" class="btn btn-primary">Schedule Appointment</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="bg-light">
    <div class="container">
      <h2 class="section-title">Frequently Asked Questions</h2>
      
      <div class="grid grid-2">
        <div class="card">
          <h3>What industries do you serve?</h3>
          <p>We work across government, healthcare, retail, energy, and technology, tailoring our services and products to the specific regulatory, operational, and business needs of each sector.</p>
        </div>
        
        <div class="card">
          <h3>Do you offer training for our team?</h3>
          <p>Yes! We provide comprehensive training programs to ensure your team can effectively use and maintain the AI solutions we implement.</p>
        </div>
        
        <div class="card">
          <h3>What is the cost of your services?</h3>
          <p>Pricing varies based on project scope and requirements. Contact us for a customized quote tailored to your specific needs.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Appointment Modal -->
  <div id="appointment-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;">
    <div style="background: white; max-width: 600px; margin: 2rem auto; padding: 2rem; border-radius: 0.5rem; position: relative;">
      <button id="close-modal" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666;">&times;</button>
      <h2>Schedule Appointment</h2>
      <p>Please fill in your information and select your preferred dates and times.</p>
      
      <form id="appointment-form" style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1.5rem;">
        <div>
          <label for="apt-name" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Name *</label>
          <input 
            type="text" 
            id="apt-name" 
            name="apt-name" 
            required 
            style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
          />
        </div>
        
        <div>
          <label for="apt-email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Email *</label>
          <input 
            type="email" 
            id="apt-email" 
            name="apt-email" 
            required 
            style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
          />
        </div>
        
        <div>
          <label for="apt-phone" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Phone</label>
          <input 
            type="tel" 
            id="apt-phone" 
            name="apt-phone" 
            style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
          />
        </div>
        
        <div>
          <label for="apt-company" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Company</label>
          <input 
            type="text" 
            id="apt-company" 
            name="apt-company" 
            style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
          />
        </div>
        
        <div>
          <label for="apt-info" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Additional Information</label>
          <textarea 
            id="apt-info" 
            name="apt-info" 
            rows="4"
            style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem; resize: vertical;"
          ></textarea>
        </div>
        
        <div>
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">First Preferred Date & Time *</label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
            <input 
              type="date" 
              id="apt-date1" 
              name="apt-date1" 
              required 
              style="padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
            />
            <input 
              type="time" 
              id="apt-time1" 
              name="apt-time1" 
              required 
              style="padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
            />
          </div>
        </div>
        
        <div>
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Second Preferred Date & Time *</label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
            <input 
              type="date" 
              id="apt-date2" 
              name="apt-date2" 
              required 
              style="padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
            />
            <input 
              type="time" 
              id="apt-time2" 
              name="apt-time2" 
              required 
              style="padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem;"
            />
          </div>
        </div>
        
        <button type="submit" class="btn btn-primary btn-large">Submit Appointment Request</button>
      </form>
    </div>
  </div>

  <script>
    // Contact form handling with Web3Forms
    const contactForm = document.getElementById('contact-form') as HTMLFormElement;
    const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
    const buttonText = document.getElementById('button-text') as HTMLSpanElement;
    const buttonLoading = document.getElementById('button-loading') as HTMLSpanElement;
    const formMessage = document.getElementById('form-message') as HTMLDivElement;
    
    if (contactForm) {
      contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Show loading state
        submitBtn.disabled = true;
        buttonText.style.display = 'none';
        buttonLoading.style.display = 'inline';
        formMessage.style.display = 'none';
        
        try {
          const formData = new FormData(contactForm);
          
          // Check if access key is configured
          const accessKey = formData.get('access_key') as string;
          if (!accessKey || accessKey === 'YOUR_ACCESS_KEY_HERE') {
            // Fallback to mailto if Web3Forms is not configured
            const name = formData.get('name');
            const email = formData.get('email');
            const company = formData.get('company');
            const subject = formData.get('subject');
            const message = formData.get('message');
            
            const mailtoLink = `mailto:mark.vanengelen@gulo.ai?subject=${encodeURIComponent(String(subject))}&body=${encodeURIComponent(
              `Name: ${name}\nEmail: ${email}\nCompany: ${company}\n\nMessage:\n${message}`
            )}`;
            
            window.location.href = mailtoLink;
            
            // Reset form and button state
            contactForm.reset();
            submitBtn.disabled = false;
            buttonText.style.display = 'inline';
            buttonLoading.style.display = 'none';
            
            formMessage.textContent = 'Your message has been prepared. Your email client should open shortly.';
            formMessage.style.display = 'block';
            formMessage.style.backgroundColor = '#dbeafe';
            formMessage.style.color = '#1e40af';
            return;
          }
          
          // Send form data to Web3Forms
          const response = await fetch('https://api.web3forms.com/submit', {
            method: 'POST',
            body: formData
          });
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const data = await response.json();
          
          if (data.success) {
            // Show success message
            formMessage.textContent = 'Thank you! Your message has been sent successfully. We will get back to you soon.';
            formMessage.style.display = 'block';
            formMessage.style.backgroundColor = '#dcfce7';
            formMessage.style.color = '#166534';
            
            // Reset form
            contactForm.reset();
          } else {
            throw new Error(data.message || 'Something went wrong');
          }
        } catch (error) {
          // Show error message
          formMessage.textContent = 'Sorry, there was an error sending your message. Please try again or contact us directly at mark.vanengelen@gulo.ai';
          formMessage.style.display = 'block';
          formMessage.style.backgroundColor = '#fee2e2';
          formMessage.style.color = '#991b1b';
        } finally {
          // Reset button state
          submitBtn.disabled = false;
          buttonText.style.display = 'inline';
          buttonLoading.style.display = 'none';
        }
      });
    }
    
    // Appointment modal handling
    const scheduleBtn = document.getElementById('schedule-appointment-btn');
    const modal = document.getElementById('appointment-modal');
    const closeModalBtn = document.getElementById('close-modal');
    const appointmentForm = document.getElementById('appointment-form') as HTMLFormElement;
    
    function openModal() {
      if (modal) {
        modal.style.display = 'block';
      }
    }
    
    if (scheduleBtn && modal) {
      scheduleBtn.addEventListener('click', openModal);
    }
    
    if (closeModalBtn && modal) {
      closeModalBtn.addEventListener('click', function() {
        modal.style.display = 'none';
      });
    }
    
    if (modal) {
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.style.display = 'none';
        }
      });
    }
    
    // Handle hash change for footer link
    function checkHash() {
      if (window.location.hash === '#schedule-appointment') {
        openModal();
      }
    }
    
    // Check hash on load
    checkHash();
    
    // Check hash when it changes
    window.addEventListener('hashchange', checkHash);
    
    if (appointmentForm) {
      appointmentForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(appointmentForm);
        const name = formData.get('apt-name');
        const email = formData.get('apt-email');
        const phone = formData.get('apt-phone');
        const company = formData.get('apt-company');
        const info = formData.get('apt-info');
        const date1 = formData.get('apt-date1');
        const time1 = formData.get('apt-time1');
        const date2 = formData.get('apt-date2');
        const time2 = formData.get('apt-time2');
        
        const subject = 'Appointment Request';
        const body = `Name: ${name}\nEmail: ${email}\nPhone: ${phone}\nCompany: ${company}\n\nAdditional Information:\n${info}\n\nPreferred Date & Time Options:\n1. ${date1} at ${time1}\n2. ${date2} at ${time2}`;
        
        const mailtoLink = `mailto:mark.vanengelen@gulo.ai?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        
        window.location.href = mailtoLink;
        
        // Reset form and close modal
        appointmentForm.reset();
        if (modal) {
          modal.style.display = 'none';
        }
        alert('Your appointment request has been prepared. Your email client should open shortly.');
      });
    }
  </script>
</BaseLayout>
